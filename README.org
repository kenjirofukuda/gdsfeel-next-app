#+title: gdsfeel-js
#+author: kenjirofukuda@gmail.com
#+options: toc:nil num:nil ^:nil ^:{}
#+HTML_HEAD_EXTRA: <style> .figure p {text-align: left;}</style>

* GdsFeel TypeScript実装

関連リポジトリ、[[https://github.com/kenjirofukuda/gdsfeel-php][gdsfeel-php]] のJavaScript実装を抜き出して型ヒントを付加したもの。
- <2025-10-21 Tue> gdsfeel-php に単一ファイルにまとめた、gdsall.js を実験使用中

- 親リポジトリ :: [[https://github.com/kenjirofukuda/gdsfeel-common][gdsfeel-common]]

#+begin_example
.
├── dist                   # <---- ignore
│   ├── gds                # <---- gdsall.js で置き換えた。
│   │   ├── browser
│   │   │   └── canvas.js
│   │   ├── container.js
│   │   ├── elements.js
│   │   └── gds.js
│   ├── geometry           # <---- gdsall.js で置き換えた。
│   ├    └── geo.js
│   ├── gdsall.js          # <---- 現在は単一ファイルにまとめたものを使用
├── gdsjs                  # <---- gdsfeel-php時代のバニラjs (参考同居) 動作確認が取れたら削除
│   ├── gds-canvas.js
│   ├── gds-container.js
│   ├── gds-elements.js
│   ├── gds.js
│   └── geo.js
├── package.json
├── package-lock.json
├── README.org
├── src                    # <----- TypeScript 実装
│   ├── gds                # gds/直下は、browser/server共通
│   │   ├── browser
│   │   │   └── canvas.ts
│   │   ├── server         # <---- 未実装 nodejs 学習中
│   │   │   │── inform.ts
│   │   │   └── outform.ts
│   │   ├── container.ts
│   │   ├── elements.ts
│   │   └── gds.ts
│   └── geometry
│       └── geo.ts
└── tsconfig.json
#+end_example

* [TODO]
** TODO createjs.Matrix2D から DOMMatrix への変更

- https://developer.mozilla.org/ja/docs/Web/API/DOMMatrix

* コンパイル

#+begin_src bash :results raw :dir (file-name-directory (buffer-file-name))
  npm install
  npm run build
#+end_src

#+begin_example

> build
> run-s tsc fix


> tsc
> tsc -p .


> fix
> fix-esm-import-path dist/

done.

> build
> run-s tsc fix

#+end_example

** メンテナンススクリプト
以下のスクリプトは製作者固有のディレクトリ構造なので実行しないこと

#+caption: gdsfeel-phpへの実験転送
#+begin_src bash :dir (file-name-directory (buffer-file-name))
  npm run tsc-onejs
  src=./dist/onejs/gdsall.js
  dst=~/Nextcloud/prove/php-room/gdsfeel-php/ts-dist/gdsall.js
  cp "$src" "$dst"
#+end_src

#+caption: gdsfeel-php2への実験転送
#+begin_src bash :dir (file-name-directory (buffer-file-name))
  npm run tsc-onejs
  src=./dist/onejs/gdsall.js
  dst=~/Nextcloud/prove/php-room/gdsfeel-php2/public/gdsfeel.js
  cp "$src" "$dst"
#+end_src

